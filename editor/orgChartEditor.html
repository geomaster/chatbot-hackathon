<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Org Chart Editor</title>
        <meta name="description" content="An organization chart editor -- edit details and change relationships." />
        <!-- Copyright 1998-2017 by Northwoods Software Corporation. -->
        <meta charset="UTF-8">
        <script src="js/go.js"></script>

        <link rel="stylesheet" href="css/dataInspector.css" />
        <link rel="stylesheet" href="css/editor.css" />
        <script src="js/dataInspector.js"></script>

        <script src="js/orgChartEditor.js">
        </script>
    </head>
    <body onload="init()">
        <div id="controls">
            <a href="#" onclick="toggelClass('monaco', 'inspector active', 'inspector')">In</a>
            <a href="#" onclick="toggelClass('jsonGui', 'active', '')">S/L</a>
        </div>
        <div id="sample">
            <div id="myDiagramDiv"></div>
            <div id="jsonGui">
                <button id="SaveButton" onclick="save()">Save</button>
                <button onclick="load()">Load</button>
                Diagram Model saved in JSON format:
                <textarea id="mySavedModel" style="width:100%;height:250px">
                    { "class": "go.TreeModel",
                    "nodeDataArray": [
                    ]
                    }</textarea>
            </div>

            <div id="myInspector">
            </div>

            </textarea>
        </div>
        <div class="inspector" id="monaco">

        </div>
        <script src="js/monaco-editor/min/vs/loader.js"></script>
        <script>
        require.config({ paths: { 'vs': 'js/monaco-editor/min/vs' }});
        require(['vs/editor/editor.main'], function() {
            var editor = monaco.editor.create(document.getElementById("monaco"), {
                value: [
                    '{',
                    '}'
                ].join('\n'),
                language: 'json'
            });

            editor.getModel().onDidChangeContent(function(e) {
                var text = editor.getModel().getValue();
                if (window._selected) {
                    window.myDiagram.model.setDataProperty(window._selected, "json",
                        text);

                    try {
                        var json = JSON.parse(text);
                        if (json.message.text) {
                            window.myDiagram.model.setDataProperty(window._selected,
                            "message_text", json.message.text);
                        }
                    } catch (e) {
                    }
                }
                console.log("EDIT", window._selected);
            });
            window._monaco = editor;
        });


        </script>
        </div>
    </body>
</html>
